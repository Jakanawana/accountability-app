<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<title>Show Up</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
font-family:system-ui;
background:#f4efe9;
margin:0;
padding:1rem;
color:#222;
}

h1{text-align:center;margin-bottom:1rem;}

.panel{
background:white;
padding:1rem;
border-radius:14px;
margin-bottom:1rem;
box-shadow:0 4px 10px rgba(0,0,0,.05);
}

input,button{
width:100%;
padding:.7rem;
margin-top:.5rem;
font-size:1rem;
}

button{
border:none;
border-radius:10px;
background:#6b7b6b;
color:white;
}

/* Weekday selector */

.dayGrid{
display:grid;
grid-template-columns:repeat(7,1fr);
gap:.3rem;
margin-top:.5rem;
}

.dayBtn{
background:#ddd;
color:#222;
padding:.5rem;
border-radius:8px;
cursor:pointer;
font-size:.8rem;
}

.dayBtn.active{
background:#6b7b6b;
color:white;
}

#lockScreen{
position:fixed;
inset:0;
background:#111;
color:white;
display:none;
align-items:center;
justify-content:center;
text-align:center;
padding:2rem;
z-index:999;
}
</style>

</head>

<body>

<h1>Show up.</h1>

<!-- Task Input -->

<div class="panel">

<input id="taskTitle" placeholder="Task">
<input id="taskTime" type="time">
<input id="taskDuration" type="number" placeholder="Minutes">

<!-- Weekday Selector -->

<div class="dayGrid" id="dayGrid">
<div class="dayBtn" data-day="0">Sun</div>
<div class="dayBtn" data-day="1">Mon</div>
<div class="dayBtn" data-day="2">Tue</div>
<div class="dayBtn" data-day="3">Wed</div>
<div class="dayBtn" data-day="4">Thu</div>
<div class="dayBtn" data-day="5">Fri</div>
<div class="dayBtn" data-day="6">Sat</div>
</div>

<button onclick="addTask()">Commit</button>

</div>

<!-- Task List -->

<div class="panel" id="taskList"></div>

<!-- Lock -->

<div id="lockScreen">
<h2 id="lockText"></h2>
<button onclick="completeTask()">Done</button>
</div>

<script>

/* ---------- STATE ---------- */

let tasks =
JSON.parse(localStorage.getItem("tasks")||"[]");

let activeTask=null;

/* ---------- DAY SELECTOR ---------- */

document
.querySelectorAll(".dayBtn")
.forEach(btn=>{

btn.addEventListener("click",()=>{

btn.classList.toggle("active");

});

});

/* ---------- SAVE ---------- */

function save(){

localStorage.setItem(
"tasks",
JSON.stringify(tasks)
);

render();

}

/* ---------- ADD ---------- */

function addTask(){

let title=
document.getElementById("taskTitle").value;

let time=
document.getElementById("taskTime").value;

let duration=parseInt(
document.getElementById("taskDuration").value
);

let days=[...document
.querySelectorAll(".dayBtn.active")]
.map(b=>parseInt(b.dataset.day));

if(!title||!time||!duration)return;

let now=new Date();
let [h,m]=time.split(":");
now.setHours(h,m,0,0);

tasks.push({

id:Date.now(),
title,
start:now.getTime(),
duration,
days,
template:true,
done:false

});

save();

}

/* ---------- SPAWN ---------- */

function spawn(){

let today=new Date().getDay();

tasks
.filter(t=>t.template)
.forEach(t=>{

if(!t.days.includes(today))return;

let exists=tasks.some(x=>
!x.template &&
x.title===t.title &&
new Date(x.start)
.toDateString()===
new Date().toDateString()
);

if(!exists){

tasks.push({

...t,
id:Date.now(),
template:false,
start:new Date().getTime(),
done:false

});

}

});

save();

}

/* ---------- RENDER ---------- */

function render(){

let list=
document.getElementById("taskList");

list.innerHTML="";

tasks
.filter(t=>!t.template && !t.done)
.forEach(t=>{

let div=document.createElement("div");

div.textContent=t.title;

list.appendChild(div);

});

}

/* ---------- CHECK ---------- */

function check(){

let now=Date.now();

tasks.forEach(t=>{

if(t.done||t.template)return;

let end=t.start+(t.duration*60000);

if(now>end){

activeTask=t;

document.getElementById(
"lockText"
).innerText=t.title;

document.getElementById(
"lockScreen"
).style.display="flex";

}

});

}

/* ---------- COMPLETE ---------- */

function completeTask(){

activeTask.done=true;

document.getElementById(
"lockScreen"
).style.display="none";

save();

}

/* ---------- START ---------- */

spawn();
setInterval(spawn,3600000);
setInterval(check,60000);

render();

</script>

</body>
</html>
